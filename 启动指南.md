# LinkMe 后端服务启动指南

## 📋 环境要求

在启动后端服务之前，请确保已安装以下环境：

- **JDK 17+** (必需)
- **MySQL 8.0+** (必需)
- **Maven 3.6+** (必需)
- **Redis 6.0+** (可选，当前配置中已注释，暂不需要)

## 🗄️ 数据库准备

### 1. 创建数据库

首先需要创建 MySQL 数据库：

```sql
CREATE DATABASE IF NOT EXISTS linkme CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 2. 导入数据库脚本

数据库初始化脚本位于：`src/main/resources/sql/init.sql`

```bash
# 使用 MySQL 命令行导入
mysql -u root -p123456 linkme < src/main/resources/sql/init.sql
```

或者使用 MySQL 客户端工具（如 Navicat、MySQL Workbench）执行 `init.sql` 文件。

### 3. 检查数据库配置

确认 `src/main/resources/application.yml` 中的数据库配置正确：

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/linkme?useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
    username: root        # 根据你的MySQL用户名修改
    password: 123456      # 根据你的MySQL密码修改
```

## 🚀 启动方式

### 方式一：使用 Maven 命令启动（推荐）

在项目根目录 `LinkMe-backend/LinkMe-bankend/` 下执行：

```bash
# Windows PowerShell
cd LinkMe-backend\LinkMe-bankend
mvn spring-boot:run

# 或者 Linux/Mac
cd LinkMe-backend/LinkMe-bankend
mvn spring-boot:run
```

### 方式二：先编译再运行

```bash
# 1. 清理并编译项目
mvn clean install

# 2. 运行项目
mvn spring-boot:run
```

### 方式三：使用 IDE 启动

如果你使用 IntelliJ IDEA 或 Eclipse：

1. **IntelliJ IDEA**:
   - 打开项目
   - 找到 `LinkMeApplication.java` 文件
   - 右键选择 "Run 'LinkMeApplication'"

2. **Eclipse**:
   - 导入 Maven 项目
   - 找到 `LinkMeApplication.java`
   - 右键 "Run As" -> "Java Application"

### 方式四：打包为 JAR 运行

```bash
# 1. 打包项目
mvn clean package

# 2. 运行生成的 JAR 文件
java -jar target/linkme-backend-0.0.1-SNAPSHOT.jar
```

## ✅ 验证启动成功

启动成功后，你应该看到类似以下日志：

```
Started LinkMeApplication in X.XXX seconds
```

### 检查服务状态

1. **检查端口占用**：
   - 服务默认运行在 `http://localhost:8080`
   - 访问 `http://localhost:8080` 应该能看到响应（或404，说明服务已启动）

2. **访问 API 文档**：
   - Swagger UI: `http://localhost:8080/swagger-ui.html`
   - 或者: `http://localhost:8080/swagger-ui/index.html`

3. **测试 API 接口**：
   ```bash
   # 测试用户注册接口
   curl -X POST http://localhost:8080/user/register \
     -H "Content-Type: application/json" \
     -d '{"username":"testuser","email":"test@example.com","phone":"13800138000","password":"123456","nickname":"测试用户","gender":"男","birthday":"1990-01-01"}'
   ```

## 🔧 常见问题

### 1. 端口被占用

如果 8080 端口已被占用，可以修改 `application.yml`：

```yaml
server:
  port: 8081  # 改为其他端口
```

### 2. 数据库连接失败

- 检查 MySQL 服务是否启动
- 检查数据库配置是否正确（用户名、密码、数据库名）
- 确认数据库 `linkme` 已创建
- 检查 MySQL 是否允许远程连接（如果是远程数据库）

### 3. Java 版本不匹配

确认 Java 版本：
```bash
java -version
```

应该显示 Java 17 或更高版本。如果不是，需要安装 JDK 17。

### 4. Maven 依赖下载失败

```bash
# 清理本地仓库缓存
mvn clean

# 强制更新依赖
mvn clean install -U
```

### 5. 缺少数据库表

如果启动时报表不存在，请执行初始化 SQL 脚本：
```bash
mysql -u root -p123456 linkme < src/main/resources/sql/init.sql
```

## 📝 前端配置

前端服务已经配置为连接到 `http://localhost:8080`，如果后端运行在其他端口，需要修改前端配置：

文件：`LinkMe-frontend/LinkMe-frontend/src/api/request.js`

```javascript
const request = axios.create({
  baseURL: 'http://localhost:8080', // 修改为你的后端地址
  timeout: 10000
})
```

## 🎯 快速启动命令汇总

```bash
# 1. 进入后端目录
cd LinkMe-backend\LinkMe-bankend

# 2. 启动服务
mvn spring-boot:run

# 服务将在 http://localhost:8080 启动
```

## 📚 相关文档

- API 文档: `API.md`
- 项目 README: `README.md`
- 数据库设计文档: 项目根目录下的 `数据库设计.docx`

